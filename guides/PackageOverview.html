<html>
<head>
<meta charset="utf-8">
<title>N1 — Building a Package</title>
<meta property="og:title" content="An extensible mail client built on the modern web | N1">
<meta property="og:type" content="website">
<meta property="og:image" content="https://nylas.github.io/N1/images/meta_share.png">
<link rel="shortcut icon" href="/N1/images/favicon.ico">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<link rel="stylesheet" type="text/css" href="/N1/css/main.css"/>
<link rel="stylesheet" type="text/css" href="/N1/css/tomorrow.css">
</head>
<body>
<div id="header">
  <div class="container">
    <img src="/images/edgehill.png" class="logo" />
    <div class="title">N1<div class="small">Developer Preview</div></div>
  </div>
</div>

<div class="container">

<div class="page-title">Building a Package</div>

<div id="sidebar">
  <div class="heading">Getting Started</div>
  <ul>
        <li><a href="/guides/FirstSteps.html" >First Steps</a></li>
  </ul>
  <div class="heading">Guides</div>
  <ul>
        <li><a href="/guides/InterfaceConcepts.html" >Interface Concepts</a></li>
        <li><a href="/guides/PackageOverview.html" >Building a Package</a></li>
        <li><a href="/guides/React.html" >Interface Components</a></li>
        <li><a href="/guides/Architecture.html" >Application Architecture</a></li>
        <li><a href="/guides/Debugging.html" >Debugging N1</a></li>
        <li><a href="/guides/Database.html" >Accessing the Database</a></li>
        <li><a href="/guides/DraftStoreExtensions.html" >Extending the Composer</a></li>
        <li><a href="/guides/WritingSpecs.html" >Writing Specs</a></li>
  </ul>
  <div class="heading">Sample Code</div>
  <ul>
        <li><a href="https://github.com/nylas/edgehill-plugins/tree/master/translate" target="_blank">Composer Translation</a></li>
        <li><a href="https://github.com/nylas/edgehill-plugins/tree/master/sidebar-github-profile" target="_blank">Github Sidebar</a></li>
  </ul>
  <div class="heading">API Reference</div>
  <ul>
        <div class="heading">General</div>
        <ul>
              <li><a href="/docs/Actions.html" >Actions</a></li>
              <li><a href="/docs/Atom.html" >Atom</a></li>
              <li><a href="/docs/BufferedNodeProcess.html" >BufferedNodeProcess</a></li>
              <li><a href="/docs/BufferedProcess.html" >BufferedProcess</a></li>
              <li><a href="/docs/ChangeFolderTask.html" >ChangeFolderTask</a></li>
              <li><a href="/docs/ChangeLabelsTask.html" >ChangeLabelsTask</a></li>
              <li><a href="/docs/Config.html" >Config</a></li>
              <li><a href="/docs/DraggableImg.html" >DraggableImg</a></li>
              <li><a href="/docs/FocusTrackingRegion.html" >FocusTrackingRegion</a></li>
              <li><a href="/docs/Switch.html" >Switch</a></li>
              <li><a href="/docs/Task.html" >Task</a></li>
              <li><a href="/docs/TaskQueueStatusStore.html" >TaskQueueStatusStore</a></li>
        </ul>
        <div class="heading">Component Kit</div>
        <ul>
              <li><a href="/docs/EventedIFrame.html" >EventedIFrame</a></li>
              <li><a href="/docs/Flexbox.html" >Flexbox</a></li>
              <li><a href="/docs/InjectedComponent.html" >InjectedComponent</a></li>
              <li><a href="/docs/InjectedComponentSet.html" >InjectedComponentSet</a></li>
              <li><a href="/docs/Menu.html" >Menu</a></li>
              <li><a href="/docs/MenuItem.html" >MenuItem</a></li>
              <li><a href="/docs/MenuNameEmailItem.html" >MenuNameEmailItem</a></li>
              <li><a href="/docs/MultiselectActionBar.html" >MultiselectActionBar</a></li>
              <li><a href="/docs/MultiselectList.html" >MultiselectList</a></li>
              <li><a href="/docs/Popover.html" >Popover</a></li>
              <li><a href="/docs/ResizableRegion.html" >ResizableRegion</a></li>
              <li><a href="/docs/RetinaImg.html" >RetinaImg</a></li>
              <li><a href="/docs/Spinner.html" >Spinner</a></li>
              <li><a href="/docs/TimeoutTransitionGroupChild.html" >TimeoutTransitionGroupChild</a></li>
              <li><a href="/docs/UnsafeComponent.html" >UnsafeComponent</a></li>
        </ul>
        <div class="heading">Models</div>
        <ul>
              <li><a href="/docs/Account.html" >Account</a></li>
              <li><a href="/docs/Calendar.html" >Calendar</a></li>
              <li><a href="/docs/Contact.html" >Contact</a></li>
              <li><a href="/docs/File.html" >File</a></li>
              <li><a href="/docs/Folder.html" >Folder</a></li>
              <li><a href="/docs/Label.html" >Label</a></li>
              <li><a href="/docs/Message.html" >Message</a></li>
              <li><a href="/docs/Model.html" >Model</a></li>
              <li><a href="/docs/Thread.html" >Thread</a></li>
        </ul>
        <div class="heading">Stores</div>
        <ul>
              <li><a href="/docs/AccountStore.html" >AccountStore</a></li>
              <li><a href="/docs/ComponentRegistry.html" >ComponentRegistry</a></li>
              <li><a href="/docs/ContactStore.html" >ContactStore</a></li>
              <li><a href="/docs/EventStore.html" >EventStore</a></li>
              <li><a href="/docs/FocusedContentStore.html" >FocusedContentStore</a></li>
              <li><a href="/docs/MessageStoreExtension.html" >MessageStoreExtension</a></li>
              <li><a href="/docs/TaskQueue.html" >TaskQueue</a></li>
              <li><a href="/docs/WorkspaceStore.html" >WorkspaceStore</a></li>
        </ul>
        <div class="heading">Database</div>
        <ul>
              <li><a href="/docs/Attribute.html" >Attribute</a></li>
              <li><a href="/docs/AttributeBoolean.html" >AttributeBoolean</a></li>
              <li><a href="/docs/AttributeCollection.html" >AttributeCollection</a></li>
              <li><a href="/docs/AttributeDateTime.html" >AttributeDateTime</a></li>
              <li><a href="/docs/AttributeJoinedData.html" >AttributeJoinedData</a></li>
              <li><a href="/docs/AttributeNumber.html" >AttributeNumber</a></li>
              <li><a href="/docs/AttributeObject.html" >AttributeObject</a></li>
              <li><a href="/docs/AttributeServerId.html" >AttributeServerId</a></li>
              <li><a href="/docs/AttributeString.html" >AttributeString</a></li>
              <li><a href="/docs/DatabaseStore.html" >DatabaseStore</a></li>
              <li><a href="/docs/DatabaseView.html" >DatabaseView</a></li>
              <li><a href="/docs/Matcher.html" >Matcher</a></li>
              <li><a href="/docs/ModelQuery.html" >ModelQuery</a></li>
              <li><a href="/docs/SortOrder.html" >SortOrder</a></li>
        </ul>
        <div class="heading">Drafts</div>
        <ul>
              <li><a href="/docs/DraftChangeSet.html" >DraftChangeSet</a></li>
              <li><a href="/docs/DraftStore.html" >DraftStore</a></li>
              <li><a href="/docs/DraftStoreExtension.html" >DraftStoreExtension</a></li>
              <li><a href="/docs/DraftStoreProxy.html" >DraftStoreProxy</a></li>
        </ul>
        <div class="heading">Atom</div>
        <ul>
              <li><a href="/docs/Clipboard.html" >Clipboard</a></li>
              <li><a href="/docs/Color.html" >Color</a></li>
              <li><a href="/docs/CommandRegistry.html" >CommandRegistry</a></li>
              <li><a href="/docs/MenuManager.html" >MenuManager</a></li>
              <li><a href="/docs/PackageManager.html" >PackageManager</a></li>
              <li><a href="/docs/ScopeDescriptor.html" >ScopeDescriptor</a></li>
              <li><a href="/docs/StyleManager.html" >StyleManager</a></li>
              <li><a href="/docs/ThemeManager.html" >ThemeManager</a></li>
        </ul>
  </ul>
</div>
<div id="main" class="article">
<p>Packages lie at the heart of N1. Each part of the core experience is a separate package that uses the Nylas Package API to add functionality to the client. Want to make a read-only mail client? Remove the core <code>Composer</code> package and you&#39;ll see reply buttons and composer functionality disappear.</p>
<p>Let&#39;s explore the files in a simple package that adds a Translate option to the Composer. When you tap the Translate button, we&#39;ll display a popup menu with a list of languages. When you pick a language, we&#39;ll make a web request and convert your reply into the desired language.</p>
<h3 id="package-structure">Package Structure</h3>
<p>Each package is defined by a <code>package.json</code> file that includes its name, version and dependencies. Packages may also declare dependencies which are loaded from npm - in this case, the <a href="https://github.com/request/request">request</a> library. You&#39;ll need to <code>npm install</code> these dependencies locally when developing the package.</p>
<pre><code>{
  "<span class="hljs-attribute">name</span>": <span class="hljs-value"><span class="hljs-string">"translate"</span></span>,
  "<span class="hljs-attribute">version</span>": <span class="hljs-value"><span class="hljs-string">"0.1.0"</span></span>,
  "<span class="hljs-attribute">main</span>": <span class="hljs-value"><span class="hljs-string">"./lib/main"</span></span>,
  "<span class="hljs-attribute">description</span>": <span class="hljs-value"><span class="hljs-string">"An example package for N1"</span></span>,
  "<span class="hljs-attribute">license</span>": <span class="hljs-value"><span class="hljs-string">"Proprietary"</span></span>,
  "<span class="hljs-attribute">engines</span>": <span class="hljs-value">{
    "<span class="hljs-attribute">atom</span>": <span class="hljs-value"><span class="hljs-string">"*"</span>
  </span>}</span>,
  "<span class="hljs-attribute">dependencies</span>": <span class="hljs-value">{
    "<span class="hljs-attribute">request</span>": <span class="hljs-value"><span class="hljs-string">"^2.53"</span>
  </span>}
</span>}
</code></pre><p>Our package also contains source files, a spec file with complete tests for the behavior the package adds, and a stylesheet for CSS:</p>
<pre><code>-<span class="ruby"> package.json
</span>-<span class="ruby"> lib/
</span>   -<span class="ruby"> main.coffee
</span>   -<span class="ruby"> translate-button.cjsx
</span>-<span class="ruby"> spec/
</span>   -<span class="ruby"> main-spec.coffee
</span>-<span class="ruby"> stylesheets/
</span>   -<span class="ruby"> translate.less</span>
</code></pre><p><code>package.json</code> lists <code>lib/main</code> as the root file of our package. Since N1 runs NodeJS, we can <code>require</code> other source files, Node packages, etc.</p>
<p>N1 can read <code>js</code>, <code>coffee</code>, <code>jsx</code>, and <code>cjsx</code> files automatically.</p>
<p>Inside <code>main.coffee</code>, there are two important functions being exported:</p>
<pre><code class="lang-coffee"><span class="hljs-built_in">require</span> <span class="hljs-string">'./translate-button'</span>

<span class="hljs-built_in">module</span>.exports =

  <span class="hljs-comment"># Activate is called when the package is loaded. If your package previously</span>
  <span class="hljs-comment"># saved state using `serialize` it is provided.</span>
  <span class="hljs-comment">#</span>
  <span class="hljs-attribute">activate</span>: <span class="hljs-function"><span class="hljs-params">(<span class="hljs-property">@state</span>)</span> -&gt;</span>
    ComponentRegistry.register TranslateButton,
      <span class="hljs-attribute">role</span>: <span class="hljs-string">'Composer:ActionButton'</span>

  <span class="hljs-comment"># Serialize is called when your package is about to be unmounted.</span>
  <span class="hljs-comment"># You can return a state object that will be passed back to your package</span>
  <span class="hljs-comment"># when it is re-activated.</span>
  <span class="hljs-comment">#</span>
  <span class="hljs-attribute">serialize</span>: <span class="hljs-function">-&gt;</span>
      {}

  <span class="hljs-comment"># This optional method is called when the window is shutting down,</span>
  <span class="hljs-comment"># or when your package is being updated or disabled. If your package is</span>
  <span class="hljs-comment"># watching any files, holding external resources, providing commands or</span>
  <span class="hljs-comment"># subscribing to events, release them here.</span>
  <span class="hljs-comment">#</span>
  <span class="hljs-attribute">deactivate</span>: <span class="hljs-function">-&gt;</span>
    ComponentRegistry.unregister(TranslateButton)
</code></pre>
<blockquote>
<p>N1 uses CJSX, a CoffeeScript version of JSX, which makes it easy to express Virtual DOM in React <code>render</code> methods! You may want to add the <a href="https://github.com/babel/babel-sublime">Babel</a> plugin to Sublime Text, or the <a href="https://atom.io/packages/language-cjsx">CJSX Language</a> for syntax highlighting.</p>
</blockquote>
<h3 id="package-stylesheets">Package Stylesheets</h3>
<p>Style sheets for your package should be placed in the <em>styles</em> directory. Any style sheets in this directory will be loaded and attached to the DOM when your package is activated. Style sheets can be written as CSS or <a href="http://lesscss.org/">Less</a>, but Less is recommended.</p>
<p>Ideally, you won&#39;t need much in the way of styling. We&#39;ve provided a standard set of components which define both the colors and UI elements for any package that fits into N1 seamlessly.</p>
<p>If you <em>do</em> need special styling, try to keep only structural styles in the package stylesheets. If you <em>must</em> specify colors and sizing, these should be taken from the active theme&#39;s [ui-variables.less][ui-variables]. For more information, see the [theme variables docs][theme-variables]. If you follow this guideline, your package will look good out of the box with any theme!</p>
<p>An optional <code>stylesheets</code> array in your <code>package.json</code> can list the style sheets by name to specify a loading order; otherwise, all style sheets are loaded.</p>
<h3 id="package-assets">Package Assets</h3>
<p>Many packages need other static files, like images. You can add static files anywhere in your package directory, and reference them at runtime using the <code>nylas://</code> url scheme:</p>
<pre><code>&lt;<span class="hljs-tag">img</span> src=<span class="hljs-string">"nylas://my-package-name/assets/goofy.png"</span>&gt;

<span class="hljs-tag">a</span> = new <span class="hljs-function"><span class="hljs-title">Audio</span><span class="hljs-params">()</span></span>
<span class="hljs-tag">a</span><span class="hljs-class">.src</span> = <span class="hljs-string">"nylas://my-package-name/sounds/bloop.mp3"</span>
<span class="hljs-tag">a</span>.<span class="hljs-function"><span class="hljs-title">play</span><span class="hljs-params">()</span></span>
</code></pre><h3 id="installing-a-package">Installing a Package</h3>
<p>N1 ships with many packages already bundled with the application. When the application launches, it looks for additional packages in <code>~/.nylas/dev/packages</code>. Each package you create belongs in its own directory inside this folder.</p>
<p>In the future, it will be possible to install packages directly from within the client.</p>

</div>

</div>

<div id="footer">
  <div class="container">
    <img src="images/edgehill.png" class="logo" />
    <div class="small">N1 Developer Preview<br><em>© 2014-2015 Nylas, Inc.</em></div>
  </div>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-60022049-2', 'auto');
  ga('send', 'pageview');

</script>

</body>
</html>
